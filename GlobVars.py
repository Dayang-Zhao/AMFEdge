import numpy as np
import xarray as xr
import osgeo
import rioxarray as rxr
import geopandas as gpd
from rasterio.transform import from_origin

HYDROMONTH = 5
GRID_PATH = r"F:\Research\AMFEdge\Shapefile\Amazon_Grid_Final_15deg.shp"
AMAZON_PATH = r"F:\Shapefile\Amazon\sum_amazonia_polygons.shp"

# Extent
MIN_LON, MAX_LON, MIN_LAT, MAX_LAT = -80, -44, -21, 9
# RES, HALF_RES = 0.1, 0.05
RES, HALF_RES = 1, 0.5
NUM_LON, NUM_LAT = int((MAX_LON - MIN_LON) / RES), int((MAX_LAT - MIN_LAT) / RES)
STD_LON = np.linspace(MIN_LON+HALF_RES, MAX_LON-HALF_RES, num=NUM_LON)        
STD_LAT = np.linspace(MAX_LAT-HALF_RES, MIN_LAT+HALF_RES, num=NUM_LAT) # MUST REVERSE
STD_DA = xr.DataArray(np.zeros((NUM_LAT, NUM_LON)), coords=[("lat", STD_LAT), ("lon", STD_LON)])
STD_DA = STD_DA.rio.set_spatial_dims(x_dim='lon', y_dim='lat').rio.write_crs("EPSG:4326")

# Dists
DISTS = np.concatenate([
    np.arange(60, 301, 60), np.arange(420, 901, 120), np.arange(1080, 1801, 180),
    np.arange(2040, 3001, 240), np.arange(3300, 4501, 300), np.arange(4860, 6301, 360),
    np.arange(6720, 8401, 420), np.arange(8880, 10801, 480), np.arange(11340, 13501, 540),
    np.arange(14100, 16501, 600)
])

# Age.
AGES = np.arange(1, 35, 1)

# Classify Grids
NGRID_IDS = [384.0, 454.0, 456.0, 457.0, 524.0, 565.0, 640.0, 675.0, 676.0, 699.0, 701.0, 702.0, 
             711.0, 735.0, 736.0, 737.0, 738.0, 739.0, 740.0, 773.0, 775.0, 776.0, 806.0, 807.0, 
             809.0, 810.0, 811.0, 812.0, 813.0, 821.0, 841.0, 843.0, 847.0, 848.0, 849.0, 850.0, 
             878.0, 879.0, 881.0, 884.0, 885.0, 886.0, 887.0, 891.0, 915.0, 916.0, 919.0, 920.0, 
             921.0, 923.0, 925.0, 952.0, 953.0, 955.0, 956.0, 957.0, 960.0, 988.0, 990.0, 991.0, 
             992.0, 993.0, 997.0, 1025.0, 1026.0, 1027.0, 1028.0, 1030.0, 1031.0, 1033.0, 1061.0, 
             1062.0, 1063.0, 1064.0, 1065.0, 1066.0, 1097.0, 1098.0, 1099.0, 1100.0, 1101.0, 1102.0, 
             1137.0, 1172.0, 1174.0, 1245.0]
PGRID_IDS = [380.0, 414.0, 415.0, 416.0, 417.0, 418.0, 451.0, 452.0, 455.0, 458.0, 487.0, 488.0, 
             489.0, 491.0, 492.0, 493.0, 522.0, 523.0, 525.0, 526.0, 527.0, 528.0, 530.0, 557.0, 
             560.0, 561.0, 562.0, 563.0, 568.0, 593.0, 594.0, 595.0, 596.0, 597.0, 598.0, 599.0, 
             600.0, 601.0, 602.0, 604.0, 631.0, 633.0, 635.0, 636.0, 637.0, 665.0, 666.0, 667.0, 
             669.0, 671.0, 674.0, 700.0, 704.0, 705.0, 706.0, 707.0, 708.0, 709.0, 710.0, 713.0, 
             714.0, 741.0, 742.0, 744.0, 745.0, 747.0, 774.0, 777.0, 779.0, 780.0, 782.0, 783.0, 
             814.0, 816.0, 818.0, 820.0, 852.0, 855.0, 888.0, 892.0, 922.0, 924.0, 961.0, 989.0, 
             1036.0, 1060.0, 1068.0, 1071.0, 1103.0, 1105.0, 1138.0]

# NEGRID_IDS = [699, 700, 701, 702, 703,
#     735, 736, 737, 738, 739, 740,
#     771, 772, 773, 774, 775, 776,
#     806, 807, 808, 809, 810, 811, 812, 813,
#     841, 842, 843, 844, 845, 846, 847, 848, 849,
#     878, 879, 880, 881, 882, 883, 884, 885, 886,
#     915, 916, 917, 918, 919, 920, 921, 922,
#     952, 953, 954, 955, 956, 957, 958, 959,
#     987, 988, 989, 990, 991, 992, 993, 994, 995,
#     1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032,
#     1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068,
#     1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105,
#     1135, 1136, 1137, 1138, 1139,
#     1172, 1173, 1174,
#     1029, 1245
# ]

# SWGRID_IDS = [ 346.,  379.,  380.,  381.,  382.,  383.,  384.,  414.,  415.,
#         416.,  417.,  418.,  419.,  420.,  421.,  450.,  451.,  452.,
#         453.,  454.,  455.,  456.,  457.,  458.,  485.,  486.,  487.,
#         488.,  489.,  490.,  491.,  492.,  493.,  494.,  495.,  522.,
#         523.,  524.,  525.,  526.,  527.,  528.,  529.,  530.,  531.,
#         532.,  557.,  558.,  559.,  560.,  561.,  562.,  563.,  564.,
#         565.,  566.,  567.,  568.,  593.,  594.,  595.,  596.,  597.,
#         598.,  599.,  600.,  601.,  602.,  603.,  604.,  628.,  629.,
#         630.,  631.,  632.,  633.,  634.,  635.,  636.,  637.,  638.,
#         639.,  640.,  641.,  664.,  665.,  666.,  667.,  668.,  669.,
#         670.,  671.,  672.,  673.,  674.,  675.,  676.,  677.,  678.,
#         704.,  705.,  706.,  707.,  708.,  709.,  710.,  711.,  713.,
#         714.,  741.,  742.,  743.,  744.,  745.,  746.,  747.,  751.,
#         777.,  778.,  779.,  780.,  781.,  782.,  783.,  784.,  785.,
#         814.,  815.,  816.,  817.,  818.,  820.,  821.,  850.,  851.,
#         852.,  853.,  854.,  855.,  856.,  887.,  888.,  889.,  890.,
#         891.,  892.,  923.,  924.,  925.,  926.,  927.,  960.,  961.,
#         962.,  963.,  964.,  996.,  997., 1033., 1034., 1035., 1036.,
#        1069., 1070., 1071., 1209.]

NEGRID_IDS = [ 699.,  700.,  701.,  702.,  735.,  736.,  737.,  738.,  739.,
        740.,  774.,  775.,  776.,  806.,  807.,  809.,  810.,  811.,
        812.,  813.,  842.,  843.,  847.,  848.,  849.,  878.,  879.,
        881.,  884.,  885.,  886.,  915.,  916.,  919.,  920.,  921.,
        922.,  952.,  953.,  954.,  955.,  956.,  957.,  958.,  959.,
        987.,  991.,  992.,  993.,  994.,  995., 1024., 1027., 1030.,
       1060., 1061., 1062., 1063., 1064., 1065., 1097., 1098., 1099.,
       1102., 1105., 1136., 1137., 1138., 1172.]

SWGRID_IDS = [ 380.,  384.,  415.,  416.,  451.,  452.,  454.,  456.,  457.,
        486.,  491.,  492.,  494.,  522.,  523.,  524.,  525.,  526.,
        527.,  528.,  530.,  557.,  559.,  560.,  561.,  562.,  563.,
        565.,  593.,  595.,  597.,  598.,  599.,  600.,  601.,  604.,
        628.,  633.,  635.,  636.,  637.,  640.,  665.,  666.,  667.,
        668.,  669.,  670.,  671.,  672.,  674.,  675.,  676.,  704.,
        706.,  708.,  709.,  710.,  711.,  713.,  741.,  742.,  743.,
        744.,  745.,  747.,  777.,  780.,  783.,  814.,  815.,  816.,
        818.,  820.,  850.,  851.,  854.,  855.,  887.,  890.,  891.,
        892.,  923.,  924.,  960.,  961.,  997., 1036., 1070., 1209.]

ANDES_IDS = [
    450, 414, 379, 380, 381,
    382, 383, 384, 346, 419, 420, 421,
    456, 457,458, 594, 531, 567, 604,
    640, 677, 495,532,568, 641, 678, 714, 751
]