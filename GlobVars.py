import numpy as np
import xarray as xr
import osgeo
import rioxarray as rxr
import geopandas as gpd
from rasterio.transform import from_origin

HYDROMONTH = 4
GRID_PATH = r"F:\Research\AMFEdge\Shapefile\Amazon_Grid_Final.shp"
AMAZON_PATH = r"F:\Shapefile\Amazon\sum_amazonia_polygons.shp"

# Extent
MIN_LON, MAX_LON, MIN_LAT, MAX_LAT = -80, -44, -21, 9
RES, HALF_RES = 0.1, 0.05
NUM_LON, NUM_LAT = int((MAX_LON - MIN_LON) / RES), int((MAX_LAT - MIN_LAT) / RES)
STD_LON = np.linspace(MIN_LON+HALF_RES, MAX_LON-HALF_RES, num=NUM_LON)        
STD_LAT = np.linspace(MAX_LAT-HALF_RES, MIN_LAT+HALF_RES, num=NUM_LAT) # MUST REVERSE
STD_DA = xr.DataArray(np.zeros((NUM_LAT, NUM_LON)), coords=[("lat", STD_LAT), ("lon", STD_LON)])
STD_DA = STD_DA.rio.set_spatial_dims(x_dim='lon', y_dim='lat').rio.write_crs("EPSG:4326")

# Dists
DISTS = np.concatenate([
    np.arange(60, 301, 60), np.arange(420, 901, 120), np.arange(1080, 1801, 180),
    np.arange(2040, 3001, 240), np.arange(3300, 4501, 300), np.arange(4860, 6301, 360),
    np.arange(6720, 8401, 420), np.arange(8880, 10801, 480), np.arange(11340, 13501, 540),
    np.arange(14100, 16501, 600)
])

# Age.
AGES = np.arange(1, 35, 1)

# Classify Grids
# PGRID_IDS = [380.0, 415.0, 416.0, 451.0, 452.0, 491.0, 492.0, 522.0, 523.0, 525.0, 526.0, 527.0, 
#              528.0, 530.0, 557.0, 560.0, 561.0, 562.0, 563.0, 593.0, 595.0, 597.0, 598.0, 599.0, 
#              600.0, 601.0, 604.0, 633.0, 635.0, 636.0, 637.0, 665.0, 666.0, 667.0, 669.0, 671.0, 
#              674.0, 700.0, 704.0, 706.0, 708.0, 709.0, 710.0, 713.0, 741.0, 742.0, 744.0, 745.0, 
#              747.0, 774.0, 777.0, 780.0, 783.0, 814.0, 816.0, 818.0, 820.0, 854.0, 855.0, 892.0, 
#              922.0, 924.0, 961.0, 987.0, 994.0, 997.0, 1024.0, 1036.0, 1060.0, 1105.0, 1136.0, 
#              1138.0, 1209.0]
# NGRID_IDS = [384.0, 454.0, 456.0, 457.0, 486.0, 494.0, 524.0, 559.0, 565.0, 628.0, 640.0, 668.0, 
#              670.0, 672.0, 675.0, 676.0, 699.0, 701.0, 702.0, 711.0, 735.0, 736.0, 737.0, 738.0, 
#              739.0, 740.0, 743.0, 775.0, 776.0, 806.0, 807.0, 809.0, 810.0, 811.0, 812.0, 813.0, 
#              815.0, 842.0, 843.0, 847.0, 848.0, 849.0, 850.0, 851.0, 878.0, 879.0, 881.0, 884.0, 
#              885.0, 886.0, 887.0, 890.0, 891.0, 915.0, 916.0, 919.0, 920.0, 921.0, 923.0, 952.0, 
#              953.0, 954.0, 955.0, 956.0, 957.0, 958.0, 959.0, 960.0, 991.0, 992.0, 993.0, 995.0, 
#              1027.0, 1030.0, 1061.0, 1062.0, 1063.0, 1064.0, 1065.0, 1070.0, 1097.0, 1098.0, 
#              1099.0, 1102.0, 1137.0, 1172.0]

NEGRID_IDS = [699, 700, 701, 702, 703,
    735, 736, 737, 738, 739, 740,
    771, 772, 773, 774, 775, 776,
    806, 807, 808, 809, 810, 811, 812, 813,
    841, 842, 843, 844, 845, 846, 847, 848, 849,
    878, 879, 880, 881, 882, 883, 884, 885, 886,
    915, 916, 917, 918, 919, 920, 921, 922,
    952, 953, 954, 955, 956, 957, 958, 959,
    987, 988, 989, 990, 991, 992, 993, 994, 995,
    1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032,
    1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068,
    1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105,
    1135, 1136, 1137, 1138, 1139,
    1172, 1173, 1174,
    1029, 1245
]